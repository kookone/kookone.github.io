---
layout: post
title: 微服务利器JHipster简介
category: Blog
tags: [微服务,JHipster]
---

[JHipster](http://onekook.com/bower_components/extend/images/jHipster.png)

## 概述

### 什么是JHipster

> JHipster一个基于nodejs+yeoman的java代码生成器，提供**一整套的微服务解决方案**，其目的是快速构建最佳应用。

究其本质，JHipster只是一个Yeoman的Generator。Yeoman是Google和非Google的developer们开发的一个自动生成代码的含工作流的工具，生成代码的模板叫做Generator。

因为Generator是用Node.js编写的，所以JHipster是一个用Node.js编写的、用来生成Java代码的、一个Yeoman的Generator。

### 为什么选择JHipster

当下微服务大行其道，Java生态圈蓬勃发展，微服务化氛围愈来越浓，作为一位"资深"的码农，心中总有一个念想：能掌握一个框架，既功能完备、开箱即用；又具有良好的扩展性，使得构建大型web项目这么复杂烦琐、充满风险的工作，能变得轻松写意。

JHipster不仅仅提供一个开箱即用的框架，还提供一整套基于spring-cloud的完整微服务框架，支持使用交互式的脚手架搭建方式，还可以根据用户的喜好进行裁剪选择。jhipster在整个程序架构上都做好了整合，包括前端mvvm框架（angularjs），前端构建工具（gulp）到后端的微服务框架（spring cloud）和hibernate/mongodb，再到单元测试/ui测试。

毫不客气的说 ：学会了这套框架，你就是程序开发/程序架构界的潮男（正如它的名字一样，JHipster是一个Java弄潮儿）。 

### JHipster 技术栈

#### 前端

> 单页面程序

- `Angular 5`or`React`

- `Bootstrap`响应式布局

- `HTML5`模板

- 兼容`ie11`和现代游览器

- 国际化支持

- `scss`

- 支持`Spring WebSocket`

> 开发工具

- 支持`yarn`安装依赖

- 支持`webpack`开发

- 支持`Jest`和`Protractor`测试框架

- 支持后端`Thymeleaf`渲染

#### 后端

- Spring Boot 简化配置

- Maven or Gradle 构建工具, 测试并运行应用

- spring profiles 开发环境和生产环境 (Maven and Gradle)

- Spring Security 安全管理框架

- Spring MVC REST + Jackson

- 可选的 WebSocket 支持 with Spring Websocket

- Spring Data JPA + Bean Validation

- Liquibase 数据库版本管理

- Elasticsearch 搜索引擎

- MongoDB and Couchbase no-sql 数据库支持

- Kafka 支持

- 可选的微服务组件

- ELK应用监测

- ehcache hazelcast or Infinispan 缓存

- logback 日志管理

- HikariCP 连接池(号称最快的连接池)

- docker 打包支持

- 标准 war jar 打包支持

- 主要的微服务提供AWS, Cloud Foundry, Heroku, Kubernetes, OpenShift, Docker…

## 使用JHipster

### 安装JHipster

> JHipster 依赖node 的Yeoman框架，所以安装之前必须安装`nodejs`  

**`step 1`: 安装yeoman**

```bash
npm install -g yo
```

**`step 2`:安装JHipster**

```bash
npm install -g generator-jhipster
```

### 创建JHipster 项目

#### 了解命令行参数

基本命令：

```bash
yo jhipster --[options]
```

**options**

- –help - 答应生成器的options

- –blueprint - 指定使用一种语言. For example jhipster --blueprint kotlin

- –skip-cache - 不提示缓存在对话中会跳过 (Default: false)

- –skip-git -不添加只git仓库 (Default: false)

- –skip-install - 不自动下载依赖(Default: false)

- –skip-client - 跳过前端代码生成, 只会有后端代码生成 (Default: false)

- –skip-server - 通过后端代码生成(Default: false)

- –skip-user-management - 前后台通过用户管理生成 (Default: false)

- –i18n - 指定i18n的状态 (Default: true)

- –auth - 当取消服务端时选择授权方式，当跳过服务端时不是必须的

- –db - 指定数据库，当跳过服务端时不是必须的

- –with-entities - 覆盖已经生成的实体 (使用 .jhipster 文件夹中的配置) (Default: false)

- –skip-checks - 通过检查需要的工具 (Default: false)

- –jhi-prefix - 在服务、组件和状态/路由名称之前添加前缀(Default: jhi)

- –npm - Use NPM instead of Yarn (Default: false)

- –experimental - 启用实验功能，这些功能是不稳定的可能随时崩溃

#### 创建简单Demo项目

**`step1`:生成JHipster**

```bash
mkdir myapplication
cd myapplication/
yo jhipster
```

**`step2`:根据你的需要选择你要的选项**

> 输入完命令后悔出现一大堆的交互问答，如下

What is the base name of your application?(jhipster)
这个是问你项目是啥 输入项目名回车进行下一步

What is your default Java package name?(com.mycompany.myapp)
项目的包名

Which type of authentication would you like to use?(Use arrow keys)
上下箭头选择 根据你的业务详情选择合适的授权方案

Which type of database would you like to use?(Use arrow keys)
选择需要的数据库类型

Which production database would you like to use?(use arrow keys)
具体的数据库产品

which development database would you like to use?
开发是用什么数据库 h2保存在磁盘中不windows下有的问题

Do you want to use Hibernate 2nd level cache?
是否开启二级缓存

Do you want to use a search engine in your application?
是否需要搜索引擎

Do you want to use clustered HTTP sessions?
是否需要使用集群session

Do you want to use WebSocket?
是否需要使用websocket

Would you like to use Maven or Gradle for building the backend?
使用maven还是gradle构建项目

Would you like to use Grunt or Gulp.js for building the frontend?
是否使用glup来构建前端应用

Would you like to use the LibSass stylesheet preprocessor for your css?
是否使用LibSass作为css样式表处理器

Would you like to enable translation support with Angular Translate?
是否使用Anaglar的翻译支持

Which testing frameworks would you like to use?
选择测试框架

> 所有的问题都回答完就会自动生成项目，然后使用ide导入即可

### 使用JHipster创建实体

当你创建了你的应用，你就会想去创建实体，比如你想创建一个Author 和 Book实体，对于每个实体，你需要以下步骤

- 在数据库建立表

- Liquibase 添加一条修改记录

- 创建 JPA 实体

- 创建 JPA Repository

- 创建Spring MVC REST Controller 提供基础的CURD 操作

- 创建Angular路由，一个组件和一个service

- 创建一个HTMl页面

- 集成测试取保各个方面都正常

上面的步骤很多，大部分也都是我们日常做的东西，现在使用JHipster可以自动帮我们生成这些代码

### 使用子生成器`entity`生成代码

**entity**子生成器可以为每一个实体生成前后台的CRUD操作

例如：

```bash
jhipster entity <entityName> --[options]
```

**options**

- –table-name <table_name> - JHipster默认会根据你的实体名去创建表, 如果你的表名和你的实体名不一样可以使用这个参数

- –angular-suffix - 设置anaglar路由前缀

- –regenerate - 无提示覆盖已经生成的实体

- –skip-server - 跳过服务端代码生成

- –skip-client - 跳过前端代码生成

- –db - 指定数据库
